{% extends 'base.html' %}
{% load static %}
{% block title %}Top Animes{% endblock %}

{% block content %}
<main class="ranking-page">
    <section class="ranking-hero">
        <div class="container">
            <header class="hero-content">
                <h1 class="page-title">
                    <span class="trophy-icon" aria-hidden="true">üèÜ</span>
                    Top Animes
                </h1>
                <p class="page-subtitle">
                    Melhores animes de acordo com a comunidade!
                </p>
                <div class="ranking-stats">
                    <div class="stat-badge">
                        <span class="stat-number">{{ ranking|length }}</span>
                        <span class="stat-label">Animes Ranqueados</span>
                    </div>
                    <div class="stat-badge">
                        <span class="stat-number">{{ min_votes }}+</span>
                        <span class="stat-label">Votos M√≠nimos</span>
                    </div>
                </div>
            </header>
        </div>
    </section>

    <div class="container">
        {% if ranking %}
            <ol class="ranking-list">
                {% for anime in ranking %}
                <li class="ranking-item {% if forloop.counter <= 3 %}ranking-item-top{% endif %}" data-position="{{ forloop.counter }}">
                    <div class="ranking-position">
                        <span class="position-number {% if forloop.counter == 1 %}gold{% elif forloop.counter == 2 %}silver{% elif forloop.counter == 3 %}bronze{% endif %}">
                            #{{ forloop.counter }}
                        </span>
                        {% if forloop.counter == 1 %}
                            <span class="medal" aria-label="Primeiro lugar">1</span>
                        {% elif forloop.counter == 2 %}
                            <span class="medal" aria-label="Segundo lugar">2</span>
                        {% elif forloop.counter == 3 %}
                            <span class="medal" aria-label="Terceiro lugar">3</span>
                        {% endif %}
                    </div>

                    <a href="{% url 'animes:anime_detail' anime.anime__mal_id %}" class="ranking-card" aria-label="Ver detalhes de {{ anime.anime__title }}">
                        <figure class="ranking-poster">
                            <img 
                                src="{{ anime.anime__image_url }}" 
                                alt="Poster de {{ anime.anime__title }}"
                                loading="lazy"
                            >
                            <figcaption class="poster-overlay">
                                <span class="view-details">Ver detalhes</span>
                            </figcaption>
                        </figure>

                        <div class="ranking-info">
                            <h2 class="anime-title-ranking">{{ anime.anime__title }}</h2>
                            
                            <dl class="ranking-metrics">
                                <div class="metric-item score-metric">
                                    <svg class="metric-icon" width="20" height="20" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                    </svg>
                                    <dt class="metric-label">Nota:</dt>
                                    <dd class="metric-value score-value">{{ anime.average_score|floatformat:2 }}</dd>
                                </div>

                                <div class="metric-item votes-metric">
                                    <svg class="metric-icon" width="20" height="20" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                                        <path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"></path>
                                    </svg>
                                    <dt class="metric-label">Votos:</dt>
                                    <dd class="metric-value">{{ anime.vote_count }}</dd>
                                </div>
                            </dl>
                        </div>
                    </a>
                </li>
                {% endfor %}
            </ol>
        {% else %}
            <section class="empty-state">
                <div class="empty-icon" aria-hidden="true">üìä</div>
                <h2 class="empty-title">Nenhum anime ranqueado ainda</h2>
            </section>
        {% endif %}
    </div>
</main>
{% endblock %}